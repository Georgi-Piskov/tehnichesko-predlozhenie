<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–∞ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="toast-container" id="toastContainer"></div>

    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1>üìÑ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–∞ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</h1>
            <p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–∑–≥–æ—Ç–≤—è–Ω–µ –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∑–∞ –æ–±—â–µ—Å—Ç–≤–µ–Ω–∏ –ø–æ—Ä—ä—á–∫–∏</p>
        </header>

        <!-- Steps Indicator -->
        <div class="steps-indicator" id="stepsIndicator">
            <div class="step-item active" data-step="1">
                <span class="step-number">1</span>
                <span class="step-label">–ò–∑–ø—ä–ª–Ω–∏—Ç–µ–ª</span>
            </div>
            <div class="step-item" data-step="2">
                <span class="step-number">2</span>
                <span class="step-label">–î–æ–∫—É–º–µ–Ω—Ç–∏</span>
            </div>
            <div class="step-item" data-step="3">
                <span class="step-number">3</span>
                <span class="step-label">–ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ</span>
            </div>
            <div class="step-item" data-step="4">
                <span class="step-number">4</span>
                <span class="step-label">–†–µ–∑—É–ª—Ç–∞—Ç</span>
            </div>
        </div>

        <!-- ========== STEP 1: Contractor Info ========== -->
        <div class="section-panel active" id="step1">
            <div class="card">
                <h2 class="card-title"><span class="icon">üè¢</span> –î–∞–Ω–Ω–∏ –∑–∞ –∏–∑–ø—ä–ª–Ω–∏—Ç–µ–ª—è</h2>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ñ–∏—Ä–º–∞—Ç–∞ <span class="required">*</span></label>
                        <input type="text" class="form-input" id="companyName" placeholder="–Ω–∞–ø—Ä. –ë–ê–†–ò–ù –ê–õ–ü –ï–û–û–î">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–ï–ò–ö <span class="required">*</span></label>
                        <input type="text" class="form-input" id="companyEik" placeholder="–Ω–∞–ø—Ä. 202151992">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–ê–¥—Ä–µ—Å <span class="required">*</span></label>
                        <input type="text" class="form-input" id="companyAddress" placeholder="–Ω–∞–ø—Ä. –≥—Ä. –°–º–æ–ª—è–Ω, —É–ª. –ë—ä–ª–≥–∞—Ä–∏—è 14">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–£–ø—Ä–∞–≤–∏—Ç–µ–ª <span class="required">*</span></label>
                        <input type="text" class="form-input" id="companyManager" placeholder="–¢—Ä–∏—Ç–µ –∏–º–µ–Ω–∞">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                        <input type="text" class="form-input" id="companyPhone" placeholder="–Ω–∞–ø—Ä. 0888 123 456">
                    </div>
                    <div class="form-group">
                        <label class="form-label">–ï-mail</label>
                        <input type="email" class="form-input" id="companyEmail" placeholder="office@company.bg">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —Ñ–∏—Ä–º–∞—Ç–∞</label>
                    <textarea class="form-textarea" id="companyDescription" rows="3"
                        placeholder="–û—Å–Ω–æ–≤–Ω–∞ –¥–µ–π–Ω–æ—Å—Ç, –æ–ø–∏—Ç, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∏ (ISO, OHSAS –∏ –¥—Ä.)"></textarea>
                    <span class="form-hint">–û–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ. –©–µ –±—ä–¥–µ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–æ –∑–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ—Ç–æ.</span>
                </div>

                <div class="btn-group" style="justify-content: flex-end;">
                    <button class="btn btn-primary" onclick="goToStep(2)">–ù–∞–ø—Ä–µ–¥ ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- ========== STEP 2: Documents Upload ========== -->
        <div class="section-panel" id="step2">
            <!-- Procurement Documentation -->
            <div class="card">
                <h2 class="card-title"><span class="icon">üìã</span> –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∑–∞ –æ–±—â–µ—Å—Ç–≤–µ–Ω–∞—Ç–∞ –ø–æ—Ä—ä—á–∫–∞</h2>
                <p class="form-hint" style="margin-bottom: 1rem;">
                    –ö–∞—á–µ—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è—Ç–∞ –æ—Ç –≤—ä–∑–ª–æ–∂–∏—Ç–µ–ª—è. –°–∏—Å—Ç–µ–º–∞—Ç–∞ —â–µ –∏–∑–≤–ª–µ—á–µ –∏–∑–∏—Å–∫–≤–∞–Ω–∏—è—Ç–∞ –∑–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ—Ç–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.
                </p>
                <div class="file-upload-zone" id="docUploadZone">
                    <div class="upload-icon">üìÅ</div>
                    <div class="upload-text">
                        <strong>–ù–∞—Ç–∏—Å–Ω–µ—Ç–µ –∏–ª–∏ –ø–ª—ä–∑–Ω–µ—Ç–µ —Ñ–∞–π–ª —Ç—É–∫</strong><br>
                        PDF –∏–ª–∏ DOCX, –¥–æ 50MB
                    </div>
                    <input type="file" id="docFile" accept=".pdf,.docx,.doc">
                </div>
                <div id="docFileInfo" style="display:none;"></div>
            </div>

            <!-- Technical Specification -->
            <div class="card">
                <h2 class="card-title"><span class="icon">üìê</span> –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è</h2>
                <p class="form-hint" style="margin-bottom: 1rem;">
                    –ö–∞—á–µ—Ç–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—Ç–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è / –∑–∞–¥–∞–Ω–∏–µ. –°—ä–¥—ä—Ä–∂–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ç–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –Ω–∞ –æ–±–µ–∫—Ç–∞.
                </p>
                <div class="file-upload-zone" id="specUploadZone">
                    <div class="upload-icon">üìÅ</div>
                    <div class="upload-text">
                        <strong>–ù–∞—Ç–∏—Å–Ω–µ—Ç–µ –∏–ª–∏ –ø–ª—ä–∑–Ω–µ—Ç–µ —Ñ–∞–π–ª —Ç—É–∫</strong><br>
                        PDF –∏–ª–∏ DOCX, –¥–æ 50MB
                    </div>
                    <input type="file" id="specFile" accept=".pdf,.docx,.doc">
                </div>
                <div id="specFileInfo" style="display:none;"></div>
            </div>

            <!-- Additional context -->
            <div class="card">
                <h2 class="card-title"><span class="icon">üí°</span> –î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏ —É–∫–∞–∑–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ)</h2>
                <div class="form-group">
                    <label class="form-label">–î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</label>
                    <textarea class="form-textarea" id="additionalNotes" rows="4"
                        placeholder="–°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –∫–æ—è—Ç–æ –∏—Å–∫–∞—Ç–µ –¥–∞ –±—ä–¥–µ –æ—Ç—Ä–∞–∑–µ–Ω–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ—Ç–æ. –ù–∞–ø—Ä. –∫–æ–Ω–∫—Ä–µ—Ç–µ–Ω –æ–ø–∏—Ç —Å –ø–æ–¥–æ–±–Ω–∏ –æ–±–µ–∫—Ç–∏, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∏ –º–∞—à–∏–Ω–∏, –ø–∞—Ä—Ç–Ω—å–æ—Ä–∏ –∏ —Ç.–Ω."></textarea>
                </div>
            </div>

            <div class="btn-group" style="justify-content: space-between;">
                <button class="btn btn-secondary" onclick="goToStep(1)">‚Üê –ù–∞–∑–∞–¥</button>
                <button class="btn btn-primary btn-lg" id="generateBtn" onclick="startGeneration()">
                    üöÄ –ì–µ–Ω–µ—Ä–∏—Ä–∞–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
                </button>
            </div>
        </div>

        <!-- ========== STEP 3: Progress ========== -->
        <div class="section-panel" id="step3">
            <div class="card">
                <h2 class="card-title"><span class="icon">‚öôÔ∏è</span> –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</h2>

                <div class="progress-bar-wrapper">
                    <div class="progress-bar" id="progressBar"></div>
                </div>

                <p id="progressText" style="text-align: center; margin-bottom: 1.5rem; font-weight: 500;">
                    –°—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ...
                </p>

                <div class="progress-phases" id="progressPhases">
                    <div class="phase-item" data-phase="upload">
                        <span class="phase-icon">‚è≥</span>
                        <span>–ö–∞—á–≤–∞–Ω–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Ñ–∞–π–ª–æ–≤–µ</span>
                    </div>
                    <div class="phase-item" data-phase="extract">
                        <span class="phase-icon">‚è≥</span>
                        <span>–ò–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –∏–∑–∏—Å–∫–≤–∞–Ω–∏—è –æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è—Ç–∞</span>
                    </div>
                    <div class="phase-item" data-phase="analyze">
                        <span class="phase-icon">‚è≥</span>
                        <span>–ê–Ω–∞–ª–∏–∑ –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—Ç–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è</span>
                    </div>
                    <div class="phase-item" data-phase="plan">
                        <span class="phase-icon">‚è≥</span>
                        <span>–ü–ª–∞–Ω–∏—Ä–∞–Ω–µ –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ç–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞</span>
                    </div>
                    <div class="phase-item" data-phase="write">
                        <span class="phase-icon">‚è≥</span>
                        <span>–ü–∏—Å–∞–Ω–µ –Ω–∞ —Å–µ–∫—Ü–∏–∏ (0/0)</span>
                    </div>
                    <div class="phase-item" data-phase="validate">
                        <span class="phase-icon">‚è≥</span>
                        <span>–í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞ –ø—ä–ª–Ω–æ—Ç–∞ –∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç</span>
                    </div>
                    <div class="phase-item" data-phase="finalize">
                        <span class="phase-icon">‚è≥</span>
                        <span>–§–∏–Ω–∞–ª–Ω–∞ —Ä–µ–¥–∞–∫—Ü–∏—è –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–∞–Ω–µ</span>
                    </div>
                    <div class="phase-item" data-phase="export">
                        <span class="phase-icon">‚è≥</span>
                        <span>–ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ DOCX —Ñ–∞–π–ª</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ========== STEP 4: Result ========== -->
        <div class="section-panel" id="step4">
            <div class="card">
                <h2 class="card-title"><span class="icon">‚úÖ</span> –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ—Ç–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –µ –≥–æ—Ç–æ–≤–æ!</h2>

                <div id="resultStats" style="display: flex; gap: 1.5rem; margin-bottom: 1.5rem; flex-wrap: wrap;">
                    <div style="background: var(--primary-light); padding: 1rem 1.5rem; border-radius: 8px; flex: 1; min-width: 140px; text-align: center;">
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary);" id="statPages">0</div>
                        <div style="font-size: 0.8rem; color: var(--text-light);">–°—Ç—Ä–∞–Ω–∏—Ü–∏</div>
                    </div>
                    <div style="background: #f0fdf4; padding: 1rem 1.5rem; border-radius: 8px; flex: 1; min-width: 140px; text-align: center;">
                        <div style="font-size: 1.5rem; font-weight: 700; color: var(--success);" id="statSections">0</div>
                        <div style="font-size: 0.8rem; color: var(--text-light);">–°–µ–∫—Ü–∏–∏</div>
                    </div>
                    <div style="background: #fef3c7; padding: 1rem 1.5rem; border-radius: 8px; flex: 1; min-width: 140px; text-align: center;">
                        <div style="font-size: 1.5rem; font-weight: 700; color: #92400e;" id="statPlaceholders">0</div>
                        <div style="font-size: 0.8rem; color: var(--text-light);">–ó–∞ –ø–æ–ø—ä–ª–≤–∞–Ω–µ</div>
                    </div>
                </div>

                <div class="download-actions">
                    <button class="btn btn-success btn-lg" id="downloadDocx" onclick="downloadResult('md')">
                        üì• –ò–∑—Ç–µ–≥–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
                    </button>
                    <button class="btn btn-secondary" onclick="togglePreview()">
                        üëÅÔ∏è –ü—Ä–µ–≥–ª–µ–¥
                    </button>
                    <button class="btn btn-secondary" onclick="goToStep(1)">
                        üîÑ –ù–æ–≤–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
                    </button>
                </div>
            </div>

            <div class="card" id="previewCard" style="display: none;">
                <h2 class="card-title"><span class="icon">üëÅÔ∏è</span> –ü—Ä–µ–≥–ª–µ–¥ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞</h2>
                <div class="preview-content" id="previewContent"></div>
            </div>
        </div>
    </div>

    <script src="js/api.js"></script>
    <script src="js/fileUpload.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
